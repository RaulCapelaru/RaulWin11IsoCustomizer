<!-- RaulWin11 COMPLETE Advanced Tweaks - FirstLogonCommands -->
<!-- Această versiune include și tweaks-uri HKCU (per-user) -->
<!-- Copiază tot în secțiunea <FirstLogonCommands> din autounattend.xml -->

<!-- SYSTEM-WIDE TWEAKS (HKLM) -->

<SynchronousCommand wcm:action="add">
    <CommandLine>cmd /c reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate" /f &amp;&amp; reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU" /f</CommandLine>
    <Description>Create Windows Update keys</Description>
    <Order>1</Order>
</SynchronousCommand>

<SynchronousCommand wcm:action="add">
    <CommandLine>cmd /c reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate" /v DeferFeatureUpdates /t REG_DWORD /d 1 /f &amp;&amp; reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate" /v DeferFeatureUpdatesPeriodInDays /t REG_DWORD /d 365 /f &amp;&amp; reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate" /v BranchReadinessLevel /t REG_DWORD /d 32 /f &amp;&amp; reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate" /v ExcludeWUDriversInQualityUpdate /t REG_DWORD /d 1 /f</CommandLine>
    <Description>Security updates only</Description>
    <Order>2</Order>
</SynchronousCommand>

<SynchronousCommand wcm:action="add">
    <CommandLine>cmd /c reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU" /v NoAutoUpdate /t REG_DWORD /d 0 /f &amp;&amp; reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU" /v AUOptions /t REG_DWORD /d 2 /f &amp;&amp; reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU" /v NoAutoRebootWithLoggedOnUsers /t REG_DWORD /d 1 /f</CommandLine>
    <Description>Windows Update behavior</Description>
    <Order>3</Order>
</SynchronousCommand>

<SynchronousCommand wcm:action="add">
    <CommandLine>cmd /c reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\CloudContent" /v DisableWindowsConsumerFeatures /t REG_DWORD /d 1 /f &amp;&amp; reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\Appx" /v BlockNonAdminUserInstall /t REG_DWORD /d 1 /f &amp;&amp; reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsStore" /v AutoDownload /t REG_DWORD /d 2 /f</CommandLine>
    <Description>Prevent bloatware reinstall</Description>
    <Order>4</Order>
</SynchronousCommand>

<SynchronousCommand wcm:action="add">
    <CommandLine>cmd /c reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\DataCollection" /v AllowTelemetry /t REG_DWORD /d 0 /f &amp;&amp; reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\DataCollection" /v DoNotShowFeedbackNotifications /t REG_DWORD /d 1 /f &amp;&amp; reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\System" /v PublishUserActivities /t REG_DWORD /d 0 /f &amp;&amp; reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\System" /v UploadUserActivities /t REG_DWORD /d 0 /f</CommandLine>
    <Description>Disable telemetry</Description>
    <Order>5</Order>
</SynchronousCommand>

<SynchronousCommand wcm:action="add">
    <CommandLine>cmd /c reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\AdvertisingInfo" /v DisabledByGroupPolicy /t REG_DWORD /d 1 /f &amp;&amp; reg add "HKLM\SOFTWARE\Policies\Microsoft\InputPersonalization" /v AllowInputPersonalization /t REG_DWORD /d 0 /f</CommandLine>
    <Description>Disable advertising ID and input personalization</Description>
    <Order>6</Order>
</SynchronousCommand>

<SynchronousCommand wcm:action="add">
    <CommandLine>cmd /c reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\Windows Search" /v AllowCortana /t REG_DWORD /d 0 /f &amp;&amp; reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\Windows Search" /v DisableWebSearch /t REG_DWORD /d 1 /f &amp;&amp; reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\Windows Search" /v ConnectedSearchUseWeb /t REG_DWORD /d 0 /f &amp;&amp; reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\Windows Search" /v BingSearchEnabled /t REG_DWORD /d 0 /f</CommandLine>
    <Description>Disable Cortana and web search</Description>
    <Order>7</Order>
</SynchronousCommand>

<SynchronousCommand wcm:action="add">
    <CommandLine>cmd /c reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\OOBE" /v DisablePrivacyExperience /t REG_DWORD /d 1 /f &amp;&amp; reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\OOBE" /v DisableVoice /t REG_DWORD /d 1 /f &amp;&amp; reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\OOBE" /v HideOfficeOOBE /t REG_DWORD /d 1 /f</CommandLine>
    <Description>Skip OOBE screens</Description>
    <Order>8</Order>
</SynchronousCommand>

<SynchronousCommand wcm:action="add">
    <CommandLine>cmd /c reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\OneDrive" /v DisableFileSyncNGSC /t REG_DWORD /d 1 /f</CommandLine>
    <Description>Disable OneDrive sync</Description>
    <Order>9</Order>
</SynchronousCommand>

<SynchronousCommand wcm:action="add">
    <CommandLine>cmd /c sc config SysMain start= disabled &amp;&amp; sc config WSearch start= disabled &amp;&amp; sc config DiagTrack start= disabled &amp;&amp; sc config dmwappushservice start= disabled</CommandLine>
    <Description>Disable unnecessary services</Description>
    <Order>10</Order>
</SynchronousCommand>

<!-- USER-SPECIFIC TWEAKS (HKCU) - Run via PowerShell for default user -->

<SynchronousCommand wcm:action="add">
    <CommandLine>powershell.exe -ExecutionPolicy Bypass -NoProfile -Command "reg load HKU\DefaultUser 'C:\Users\Default\NTUSER.DAT'; reg add 'HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\AdvertisingInfo' /v Enabled /t REG_DWORD /d 0 /f; reg add 'HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Privacy' /v TailoredExperiencesWithDiagnosticDataEnabled /t REG_DWORD /d 0 /f; reg add 'HKU\DefaultUser\Control Panel\International\User Profile' /v HttpAcceptLanguageOptOut /t REG_DWORD /d 1 /f; reg unload HKU\DefaultUser"</CommandLine>
    <Description>Disable advertising and privacy for default user</Description>
    <Order>11</Order>
</SynchronousCommand>

<SynchronousCommand wcm:action="add">
    <CommandLine>powershell.exe -ExecutionPolicy Bypass -NoProfile -Command "reg load HKU\DefaultUser 'C:\Users\Default\NTUSER.DAT'; reg add 'HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager' /v SilentInstalledAppsEnabled /t REG_DWORD /d 0 /f; reg add 'HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager' /v ContentDeliveryAllowed /t REG_DWORD /d 0 /f; reg add 'HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager' /v PreInstalledAppsEnabled /t REG_DWORD /d 0 /f; reg add 'HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager' /v SubscribedContent-310093Enabled /t REG_DWORD /d 0 /f; reg add 'HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager' /v SubscribedContent-338388Enabled /t REG_DWORD /d 0 /f; reg add 'HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager' /v SubscribedContent-338389Enabled /t REG_DWORD /d 0 /f; reg unload HKU\DefaultUser"</CommandLine>
    <Description>Disable content delivery for default user</Description>
    <Order>12</Order>
</SynchronousCommand>

<SynchronousCommand wcm:action="add">
    <CommandLine>powershell.exe -ExecutionPolicy Bypass -NoProfile -Command "reg load HKU\DefaultUser 'C:\Users\Default\NTUSER.DAT'; reg add 'HKU\DefaultUser\Software\Microsoft\Speech_OneCore\Settings\OnlineSpeechPrivacy' /v HasAccepted /t REG_DWORD /d 0 /f; reg add 'HKU\DefaultUser\Software\Microsoft\InputPersonalization' /v RestrictImplicitInkCollection /t REG_DWORD /d 1 /f; reg add 'HKU\DefaultUser\Software\Microsoft\InputPersonalization' /v RestrictImplicitTextCollection /t REG_DWORD /d 1 /f; reg add 'HKU\DefaultUser\Software\Microsoft\InputPersonalization\TrainedDataStore' /v HarvestContacts /t REG_DWORD /d 0 /f; reg add 'HKU\DefaultUser\Software\Microsoft\Personalization\Settings' /v AcceptedPrivacyPolicy /t REG_DWORD /d 0 /f; reg unload HKU\DefaultUser"</CommandLine>
    <Description>Disable speech and personalization for default user</Description>
    <Order>13</Order>
</SynchronousCommand>

<SynchronousCommand wcm:action="add">
    <CommandLine>powershell.exe -ExecutionPolicy Bypass -NoProfile -Command "reg load HKU\DefaultUser 'C:\Users\Default\NTUSER.DAT'; reg add 'HKU\DefaultUser\Software\Microsoft\Siuf\Rules' /v NumberOfSIUFInPeriod /t REG_DWORD /d 0 /f; reg add 'HKU\DefaultUser\Software\Microsoft\Siuf\Rules' /v PeriodInNanoSeconds /t REG_DWORD /d 0 /f; reg add 'HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\SearchSettings' /v IsAADCloudSearchEnabled /t REG_DWORD /d 0 /f; reg add 'HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\SearchSettings' /v IsMSACloudSearchEnabled /t REG_DWORD /d 0 /f; reg add 'HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\SearchSettings' /v SafeSearchMode /t REG_DWORD /d 0 /f; reg unload HKU\DefaultUser"</CommandLine>
    <Description>Disable feedback and cloud search for default user</Description>
    <Order>14</Order>
</SynchronousCommand>

<SynchronousCommand wcm:action="add">
    <CommandLine>powershell.exe -ExecutionPolicy Bypass -NoProfile -Command "reg load HKU\DefaultUser 'C:\Users\Default\NTUSER.DAT'; reg add 'HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects' /v VisualFXSetting /t REG_DWORD /d 2 /f; reg add 'HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Explorer\Serialize' /v StartupDelayInMSec /t REG_DWORD /d 0 /f; reg add 'HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\BackgroundAccessApplications' /v GlobalUserDisabled /t REG_DWORD /d 1 /f; reg add 'HKU\DefaultUser\Control Panel\Desktop' /v MenuShowDelay /t REG_SZ /d 0 /f; reg unload HKU\DefaultUser"</CommandLine>
    <Description>Performance optimizations for default user</Description>
    <Order>15</Order>
</SynchronousCommand>

<SynchronousCommand wcm:action="add">
    <CommandLine>powershell.exe -ExecutionPolicy Bypass -NoProfile -Command "reg load HKU\DefaultUser 'C:\Users\Default\NTUSER.DAT'; reg add 'HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\location' /v Value /t REG_SZ /d Deny /f; reg unload HKU\DefaultUser"</CommandLine>
    <Description>Deny location access by default</Description>
    <Order>16</Order>
</SynchronousCommand>
